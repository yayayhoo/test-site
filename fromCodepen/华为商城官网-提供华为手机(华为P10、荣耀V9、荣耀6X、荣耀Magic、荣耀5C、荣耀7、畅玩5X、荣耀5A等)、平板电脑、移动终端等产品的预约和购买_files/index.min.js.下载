ec.load("ajax");ec.pkg("ec.index");ec.index.clickHref=function(a){window.open(a)};ec.index.sales=function(e){var a=[],b=[],c=[],d=$(e),f="";d.each(function(k,m){var l=$(m),j=l.attr("data-activityId"),h=l.attr("data-skuId"),g=l.attr("data-skuType");if(j>0){a.push(j);b.push(h);c.push(g)}});f="&activityIds="+a.join("&activityIds=")+"&skuIds="+b.join("&skuIds=")+"&types="+c.join("&types=");setTimeout(function(){new ec.ajax().get({url:"/sale/activitySkuInfo.json?_t="+new Date().getTime()+f,timeout:10000,timeoutFunction:function(){location.reload()},successFunction:function(g){if(!g.success){location.reload();return}ec.index.salesCallBack(d,g)}})},500)};ec.index.salesStatus=[];ec.index.salesCallBack=function(h,k){var f,d=[],b=new Date();b.setTime(ec.index.now.parseDate("yyyy-MM-dd HH:mm:ss"));var a=function(i,o){var n=$(o),l=n.attr("data-skutype"),m=$(".channel-button",n);switch(parseInt(i,10)){case 0:m.html("\u9a6c\u4e0a\u5f00\u59cb").attr("title","\u9a6c\u4e0a\u5f00\u59cb");if(l==3||l==4){m.attr("class","channel-button-begin")}break;case 1:if(l==3){m.html("\u53bb\u770b\u770b").attr("title","\u53bb\u770b\u770b")}else{m.html("\u7acb\u5373\u62a2\u8d2d").attr("title","\u7acb\u5373\u62a2\u8d2d")}m.attr("class","channel-button");break;case 2:m.html("\u6d3b\u52a8\u7ed3\u675f").attr("title","\u6d3b\u52a8\u7ed3\u675f");if(l==2||l==3){m.attr("class","channel-button-end")}break}};for(var c=0;c<k.infoList.length;c+=1){f=h[c];d=k.infoList[c];$(".channel-button",f).css("visibility","");if(!d||!d.id){continue}if(d.status==1){if(d.startTime&&d.startTime>=b){d.status=0}if(d.endTime&&d.endTime<=b){d.status=2}}a(d.status,f);if(d.startTime||d.endTime||d.limitAmount>0){$(".p-countdown",f).show()}if(d.limitAmount>0){$(".p-quantity",f).html("\u9650<b>"+d.limitAmount+"</b>\u53f0").show()}var e=parseFloat($(f).attr("data-price"),10);if(d.price>0){if(parseInt(d.price)==d.price){$(".p-sale-price span, .p-price span",f).html((d.price));if(parseInt(e)==e){$(".economize",f).html(e-d.price)}else{$(".economize",f).html((e-d.price).toFixed(2))}}else{$(".p-sale-price span, .p-price span",f).html((d.price).toFixed(2));if(e-d.price==0){$(".economize",f).html("0")}else{$(".economize",f).html((e-d.price).toFixed(2))}}}$(".sale-quantity",f).html(d.saleAmount);if(d.status!=2&&(d.startTime||d.endTime)){var g=($(f).attr("data-block")=="slider")?true:false,j=[];if(d.startTime){j.push(new Date(d.startTime).format("yyyy-MM-dd HH:mm:ss"))}if(d.endTime){j.push(new Date(d.endTime).format("yyyy-MM-dd HH:mm:ss"))}ec.index.salesStatus[c]=d.status;ec.ui.countdown($(".p-time",f),{html:"<b>"+(g?"":"\u5269\u4f59")+"</b><ins><i>{#hours}</i><s></s></ins><em>\u65f6</em><ins><i>{#minutes}</i><s></s></ins><em>\u5206</em><ins><i>{#seconds}</i><s></s></ins><em>\u79d2</em>",now:b,times:j,index:c,callback:function(i){ec.index.salesStatus[i.index]++;a(ec.index.salesStatus[i.index],h[i.index])}})}}};ec.ready(function(){if(ec.account.isLogin()){$("#cust_login_info").hide()}ec.index.SCROLL_GET=ec.index.getscrollLayout();var a=ec.index.bigAd,g=ec.index.smallAd,f=ec.index.bigadShowTime,e,b,c=function(){var j=b.innerHeight();var i=e.innerHeight();var k=$(".searchBar-form").offset().top-i+j;var h=$(".searchBar-form").innerHeight();$(".autocomplete-w1").parent().hide();e.slideUp(1000,function(){if(g){b.show()}$(".autocomplete-w1").parent().css({top:(k+h+"px")});$(".autocomplete-w1").parent().show();ec.index.SCROLL_GET=ec.index.getscrollLayout()});if(d){clearTimeout(d)}},d;$("#top-banner-block").html(gid("top-banner").value);e=$("#top-banner-max");b=$("#top-banner-min");if(a){e.show();$("#top-banner-max-toggle").click(c);d=setTimeout(c,f);ec.index.SCROLL_GET=ec.index.getscrollLayout()}if(g&&!a){b.show();ec.index.SCROLL_GET=ec.index.getscrollLayout()}if(!g&&!a){ec.index.SCROLL_GET=ec.index.getscrollLayout()}$("body .layout .channel-pro-item").hover(function(){$(this).addClass("pro-info-hover")},function(){$(this).removeClass("pro-info-hover")});ec.index.sales("#main-sale-list .activity-list, #slider-sale-list .activity-list");ec.index.floatLayout()});ec.index.SCROLL_GET={};ec.index.getscrollLayout=function(){var a=$(".home-channel-container .layout"),c=$(".event-float-layout"),b=[];if(a.length==0||c.length==0){return false}a.each(function(d,e){b.push($(this).offset().top)});return{scrollList:b,top:c.offset().top}};ec.index.throttle=function(e,b){var d,a=e,c=true;return function(){var g=this,f=arguments;if(c){a.apply(g,f);return c=false}if(d){return false}d=setTimeout(function(){clearTimeout(d);d=null;a.apply(g,f);return c=false},b||500)}};ec.index.floatLayout=function(){var a=$(".event-float-layout");if(a.length==0){return false}var d=$(".event-float"),m=$(".hungBar-top"),g=$(".home-channel-container .layout"),o=$(".home-channel-container"),l=$(".home-channel-container .layout .channel-title"),k="";a.find("ul").children().remove();g.each(function(i,p){k+='<li><a data-id="'+i+'" href="javascript:;">'+l.eq(i).html()+"</a></li>"});a.find("ul").append(k);a.bind("click",function(q){var p=$(q.target);if(p[0].nodeName.toLowerCase()==="a"){var i=parseInt(p.attr("data-id"));p.parent().addClass("hover").siblings().removeClass("hover");$("html,body").animate({scrollTop:ec.index.SCROLL_GET.scrollList[i]+"px"},500)}});var n=a.outerHeight(),e=d.offset(),c=e.left,b=$(window).height(),j=b/2-(n/2),h=g.length,f=true;if(document.body.clientWidth<=1400){a.hide();f=false}if($.browser.msie&&($.browser.version=="7.0")&&($.browser.version=="6.0")){a.hide();f=false}else{$(window).scroll(ec.index.throttle(function(){if(!f){return}var i=$(window).scrollTop();if(i>=b){m.fadeIn(800)}else{m.fadeOut(800)}if(i>=ec.index.SCROLL_GET.top-j){o.css("overflow","visible");d.addClass("tool-Fixed").css({top:j+"px"});$.each(ec.index.SCROLL_GET.scrollList,function(p,q){if(i>=q-20){a.find("li").eq(p).addClass("hover").siblings().removeClass("hover")}})}else{o.css("overflow","hidden");d.removeClass("tool-Fixed")}},200))}$(window).resize(ec.index.throttle(function(){if(document.body.clientWidth>1400){a.show();f=true;return}a.hide();f=false},200));if($(window).scrollTop()>0){$(window).trigger("scroll")}};
